# Docker swarm

## Replicate mode v.s Global mode
* RM為指定一個service運行容器的數量
* GM式所有符合運行條件的Node上，都運行這個容器
* RM多用於網頁伺服器，可隨時應對流量來決定容器多寡，可以不斷增加減少
* GM多用於系統監控(硬體)，每個節點只能有一個。

當RM的機器關閉時，該服務會跑到其他節點的機器上，不會再回來，而GM的則會留在那裏。

## 標籤label
* 打上標籤可以把節點分成不同環境
docker node update --label-add env=test vm2
>測試環境
docker node update --label-add env=prod vm3
>生產環境
* 命令特定節點建立新的服務
docker service create --constraint node.labels.env==test --replicas 2 --name web1 -p 8000:80 httpd
>test標籤上的節點
* 新增/移除條件
docker service update --constraint-add node.labels.env==prod web1
docker service update --constraint-rm node.labels.env==test web1
* 移除標籤
docker node update --label-rm env vm2
docker node update --label-rm env vm3